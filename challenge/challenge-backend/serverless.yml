# "service" is the name of this project. This will also be added to your AWS resource names.
service: challenge
# app: challengeapp
frameworkVersion: "4"

provider:
  name: aws
  runtime: nodejs20.x
  environment:
    MONGO_URI: ${env:MONGO_URI}
    stage: ${env:SERVERLESS_STAGE, 'AKrQP537O8bumxeWghz49xiCQbZGI6rR7NQjbd3yIqqUE'}
  # httpApi:
  #   cors:
  #     allowedOrigins:
  #       - '*'
  #     allowedHeaders:
  #       - Content-Type
  #       - X-Custom-Header
  #     allowedMethods:
  #       -GET
  #       -POST
  #       -OPTIONS
  #     allowedCredentials: false


plugins:
  - serverless-dotenv-plugin
  - serverless-offline
custom:
  serverless-offline:
    httpPort: 3000
    httpsProtocol: "security"
    # httpsProtocol: true
    # httpsKey: './security/private.key'
    # httpsCertificate: './security/cert.crt'
    # noAuth: true  # Disable authentication for local testing

functions:
  getDashboard:
    handler: handler.getDashboard
    events:
      - httpApi:
          path: /
          method: get
          # cors: true

  getDepartments:
    handler: handler.getDepartments
    events:
      - httpApi:
          path: departments
          method: get
          # cors: true

  getEmployees:
    handler: handler.getEmployees
    events:
      - httpApi:
          path: employees
          method: get
          # cors: true

  viewDetailsEmployee:
    handler: handler.viewEmployee
    events:
      - http:
          path: employees/{employeeId}
          method: get
          # cors: true

  viewDetailsDepartment:
    handler: handler.viewDepartment
    events:
      - http:
          path: departments/{departmentId}
          method: get
          # cors: true      

  deleteEmployee:
    handler: handler.deleteEmployee
    events:
      - http:
          path: employees/{employeeId}
          method: delete
          # cors: false

  deleteDepartment:
    handler: handler.deleteDepartment
    events:
      - http:
          path: departments/{departmentId}
          method: delete
          # cors: false        
  createEmployee:
      handler: handler.createEmployee
      events:
        - http:
            path: employees  # The endpoint path, for example: /employees
            method: post     # The HTTP method, in this case POST to create a new record
            # cors: false       # Enable CORS if needed for cross-origin requests